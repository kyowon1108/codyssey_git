# 컨테이너와 관련된 주요 개념 정리

## 1. 가상머신(VM)과 컨테이너의 차이

|구분|가상머신(Virtual Machine)|컨테이너(Container)|
|---|---|---|
|가상화 수준|하드웨어 수준|운영체제 수준|
|운영체제|각 VM이 자체 OS(게스트 OS) 포함|호스트 OS의 커널 공유|
|크기|수 GB(기가바이트)|수 MB(메가바이트)|
|부팅 시간|수 분|수 초|
|자원 사용|높음|낮음|
|격리|하드웨어 수준의 강한 격리|프로세스 수준의 격리|
|이식성|낮음|매우 높음|
|주요 용도|레거시 앱, 다양한 OS 필요 환경|마이크로서비스, CI/CD, 클라우드 네이티브|

- **컨테이너** :  애플리케이션과 그 종속성을 패키징하여 운영체제 커널을 공유하면서도 독립적으로 실행할 수 있는 경량화된 실행 환경

- **가상머신** : 하이퍼바이저 위에서 각각의 OS를 포함해 전체 시스템을 가상화함.

---

## 2. 컨테이너와 이미지의 차이

|구분|컨테이너(Container)|이미지(Image)|
|---|---|---|
|정의|이미지의 실행 인스턴스|실행 가능한 애플리케이션의 템플릿|
|상태|동적(실행, 중지, 삭제 등 가능)|정적(불변, 변경 불가)|
|생성 방법|이미지를 기반으로 생성|Dockerfile 등으로 빌드|
|저장 위치|호스트, 클러스터 내 임시 저장|로컬/원격 레지스트리(공유 가능)|
|수정 가능성|실행 중 변경 가능(쓰기 레이어 존재)|읽기 전용|
|역할|실제 애플리케이션 구동 환경|컨테이너 생성의 설계도, 템플릿|

- **컨테이너** : 이미지를 기반으로 생성된, 실제로 실행 중인 인스턴스임. 상태 변화가 가능하며, 실행 중 데이터 변경이 가능함.

- **이미지** : 실행 환경, 코드, 라이브러리, 설정 등을 포함한 불변의 패키지

---

## 3. 컨테이너 런타임의 정의
- 컨테이너 이미지를 실행 가능한 프로세스로 변환하고, 컨테이너의 생성, 시작, 정지, 삭제 등 라이프사이클을 관리하는 소프트웨어임.

- 주요 역할:
    - 이미지 다운로드 및 언팩
    - 컨테이너 격리 환경 구성(네임스페이스, cgroup 등)
    - 리소스 할당 및 관리
    - 네트워크, 저장소 연결 등 부가 기능 제공

---

## 4. CNCF Landscape 기준 컨테이너 런타임 종류 3가지

### 1. containerd
- 도커에서 분리되어 CNCF에 기증된 고성능 컨테이너 런타임.
- 이미지 관리, 컨테이너 실행, 네트워크, 스토리지 관리 등 지원.

### 2. CRI-O
- 쿠버네티스의 CRI(Container Runtime Interface) 표준을 구현한 경량 런타임.
- OCI(Open Container Initiative) 이미지 및 런타임 표준 준수.

### 3. runc
- OCI 표준을 구현한 저수준 컨테이너 런타임.
- 실제로 리눅스 네임스페이스, cgroup 등을 활용해 컨테이너 프로세스를 실행.

---

## 5. 도커 이미지의 레이어

- **도커 이미지는 여러 개의 레이어로 구성**되어 있음.

- 간단히 말하면 "압축 파일"의 개념에 가까움

- 각 레이어는 Dockerfile의 명령어(FROM, RUN, COPY 등) 하나하나에 대응하며, 읽기 전용 파일 시스템 스냅샷임.

- 레이어는 **불변(immutable)**하며, 변경이 필요할 때는 새로운 레이어가 추가됨.

- 여러 이미지가 동일한 레이어를 공유할 수 있어 저장 공간과 네트워크 전송 효율이 뛰어남.

- 컨테이너가 실행될 때, 이미지 위에 얇은 쓰기 가능한 컨테이너 레이어가 추가되어, 실행 중 변경사항이 이 레이어에 저장됨.

- 레이어 구조 덕분에 빌드 캐시 활용, 이미지 재사용, 빠른 배포가 가능함